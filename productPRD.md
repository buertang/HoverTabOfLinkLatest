# HoverTabOfLink 产品需求文档 (PRD)

**版本**: 2.1  
**日期**: 2025年1月18日  
**产品经理**: [产品经理姓名]  
**开发团队**: [开发团队名称]  

---

## 1. 产品概述

### 1.1. 产品名称

**HoverTabOfLink** - 链接预览悬浮窗工具

### 1.2. 产品定位

一款现代化的浏览器扩展，基于 Manifest V3 标准开发，为用户提供流畅、高效、可高度自定义的链接预览体验。通过悬浮窗口的形式，用户可以在不离开当前页面的情况下快速获取链接信息，同时支持拖拽文本搜索功能，全面提升浏览效率。

### 1.3. 目标用户

- **主要用户**: 经常需要浏览大量链接的用户，如研究人员、开发者、内容创作者、学生等。
- **次要用户**: 希望提升浏览体验的普通用户。

### 1.4. 核心价值

- **效率提升**: 无需打开新标签页即可预览链接内容，支持多种触发方式。
- **用户体验**: 流畅的动画效果、直观的操作界面和智能的平台适配。
- **高度自定义**: 丰富的设置选项，满足不同用户的个性化需求。
- **跨平台兼容**: 支持主流的基于 Chromium 的浏览器，智能适配不同操作系统。
- **多语言支持**: 支持12种语言，覆盖全球主要地区。

---

## 2. 功能详述

### 2.1. 核心功能：链接预览悬浮窗

用户通过预设的触发方式（如悬停、拖拽链接等），可以在当前页面上打开一个悬浮窗口，用于加载和显示链接指向的网页内容。

#### 2.1.1. 悬浮窗结构

悬浮窗由 `Header` 和 `Content` 两部分组成。

- **Header (顶部)**
  - **网址显示区**:
    - **功能**: 显示当前预览页面的完整 URL。
    - **交互**: 点击该区域，将在浏览器新标签页中打开此链接。
  - **操作按钮区**:
    - **固定 (Pin)**: 点击后，悬浮窗将保持在当前位置，不会因鼠标移开或触发其他链接而关闭。再次点击可取消固定。
    - **刷新 (Refresh)**: 重新加载悬浮窗内的 `iframe` 内容。
    - **新标签页打开 (Open in New Tab)**: 在浏览器新标签页中打开当前预览的链接。
    - **关闭 (Close)**: 手动关闭当前悬浮窗。
- **Content (中部)**
  - **网页渲染区**:
    - **实现**: 使用 `<iframe>` 标签来嵌入和渲染目标链接的网页内容。
    - **注意**: 需要处理目标网站设置了 `X-Frame-Options` 导致无法嵌入的情况，届时应在窗口内给予用户友好提示。
  - **尺寸调整**:
    - **位置**: 在悬浮窗的底部左右两侧，各有一个调整大小的把手。
    - **交互**: 用户可以拖拽这些把手，实时调整悬浮窗的宽度和高度。

### 2.2. 设置面板 (侧边栏)

插件的设置面板将通过浏览器侧边栏（Side Panel）API 打开，为用户提供丰富的个性化配置选项。

#### 2.2.1. 总体布局

- **顶部菜单栏**:
  - **形式**: 一排图标按钮，横向排列。
  - **交互**: 鼠标悬浮在图标上时，显示该功能的中文名称 Tooltip（例如：“链接预览设置”）。
  - **功能**: 点击图标可切换下方显示的具体设置项。当前激活的菜单项应有高亮状态。
  - **菜单项**:
    1. **链接预览设置**: 核心的预览功能相关配置。
    2. **拖拽文字设置**: 拖拽页面选中文本后的交互设置。
    3. **语言设置**: 插件界面语言相关的设置。
- **设置内容区**:
  - 根据顶部菜单栏的选择，显示对应的设置表单。

#### 2.2.2. 链接预览设置项

- **触发方式**:
  - **控件**: 下拉选择框。
  - **选项**: 拖动链接、鼠标悬停、长按、`Alt`+鼠标左键点击、`Alt`+鼠标悬停、禁用等。
  - **默认值**: 拖动链接。
- **自定义快捷键**:
  - **控件**: 下拉选择框。
  - **功能**: 允许用户选择一个修饰键 (如 `Alt`, `Cmd`, `Shift`) 与特定操作组合，作为预览的触发方式之一。
  - **默认值**: Alt。
  - **智能适配**: 系统会自动检测当前操作系统可用的修饰键，如果当前选择的修饰键在平台上不可用，会自动切换到第一个可用选项。
- **悬停延迟**:
  - **控件**: 滑块 (Slider) + 实时数值显示框。
  - **功能**: 当触发方式为"鼠标悬停"或"Alt+鼠标悬停"时，设置鼠标指针停留在链接上多长时间后才触发预览。
  - **范围**: 0.1s - 2s。
  - **步长**: 每次调整增加或减少 0.05s。
  - **默认值**: 0.1s。
- **长按延迟**:
  - **控件**: 滑块 (Slider) + 实时数值显示框。
  - **功能**: 当触发方式为"长按"时，设置鼠标按住链接多长时间后才触发预览。
  - **范围**: 0.2s - 3s。
  - **步长**: 每次调整增加或减少 0.1s。
  - **默认值**: 0.5s。
- **弹窗大小**:
  - **控件**: 下拉选择框。
  - **选项**:
    - **上次大小**: 记住用户上次关闭悬浮窗时的尺寸。
    - **小**: 固定的小尺寸。
    - **中**: 固定的中等尺寸。
    - **大**: 固定的大尺寸。
  - **默认值**: 上次大小。
- **弹窗位置**:
  - **控件**: 下拉选择框。
  - **选项**: 上次位置、屏幕居中、左侧、右侧。
  - **默认值**: 上次位置。
- **背景遮罩透明度**:
  - **控件**: 滑块 (Slider) + 实时百分比显示框。
  - **功能**: 当鼠标悬浮/聚焦在悬浮窗时，为页面背景添加一层遮罩，用户可调整其透明度以突出预览内容。
  - **范围**: 0% (完全透明) - 100% (完全不透明)。
  - **步长**: 每次调整增加或减少 5%。
  - **默认值**: 50%。
- **最多悬浮窗数量**:
  - **控件**: 下拉选择框。
  - **功能**: 限制同时打开的悬浮窗数量，当达到上限时，自动关闭最早打开的悬浮窗。
  - **选项**: 1-6个悬浮窗。
  - **默认值**: 3个。
  - **描述**: 帮助用户管理系统资源，避免过多悬浮窗影响浏览体验。
- **自动固定**:
  - **控件**: 开关 (Switch)。
  - **功能**: 启用后，新打开的悬浮窗将自动进入固定状态，不会因鼠标移开或触发其他链接而关闭。
  - **默认值**: 关闭。
  - **描述**: 适合需要同时查看多个链接内容的场景，提高工作效率。

#### 2.2.3. 拖拽文字设置

- **启用拖拽功能**:
  - **控件**: 开关 (Switch)。
  - **功能**: 启用或禁用拖拽文本功能。
  - **默认值**: 启用。
  - **描述**: 开启后，用户可以拖拽页面上的选中文本进行搜索或打开链接。
- **搜索引擎设置**:
  - **控件**: 下拉选择框。
  - **功能**: 设置拖拽选中文本后，默认使用的搜索引擎。
  - **选项**: 必应、谷歌、百度、DuckDuckGo。
  - **默认值**: 必应搜索。
  - **依赖**: 仅在启用拖拽功能时可用。
- **禁用网站列表**:
  - **控件**: 文本域 (Textarea)。
  - **功能**: 在列出的网站中，禁用通过拖拽文本进行搜索或打开链接的功能。
  - **格式**: 每行一个域名，支持通配符。
  - **验证**: 系统会实时验证域名格式，并在格式错误或超过限制数量时提供错误提示。
  - **限制**: 最多可添加50个域名。
  - **提示**: 提供域名格式提示和当前添加的域名数量统计。

#### 2.2.4. 其他设置

- **主题设置**:
  - **控件**: 按钮组。
  - **功能**: 设置插件界面的主题风格。
  - **选项**: 系统主题、浅色主题、深色主题。
  - **默认值**: 系统主题。
  - **描述**: 跟随系统主题或手动选择浅色/深色主题，提供舒适的视觉体验。
- **语言设置**:
  - **控件**: 下拉选择框。
  - **功能**: 切换插件界面的显示语言。
  - **选项**: 简体中文、繁体中文、英语、日语、韩语、法语、德语、俄语、意大利语、西班牙语、葡萄牙语、阿拉伯语。
  - **默认值**: 简体中文。
  - **描述**: 支持12种主要语言，覆盖全球主要地区用户。

## 3. 非功能性需求

### 3.1. 性能要求

- **响应速度**: 触发预览后，悬浮窗应在200ms内出现，提供即时反馈。
- **资源占用**: 扩展在未激活状态下保持极低的CPU和内存占用。
- **内存管理**: 支持长时间使用不产生内存泄漏，自动清理无用资源。
- **渲染优化**: 使用高性能的DOM操作和CSS变换，确保流畅的动画效果。

### 3.2. 兼容性要求

- **浏览器支持**: 兼容基于Chromium的主流浏览器（Chrome 88+、Edge 88+）。
- **操作系统**: 全面支持Windows、macOS、Linux系统。
- **网站兼容性**: 智能处理各种网站限制，提供友好的错误提示。
- **响应式设计**: 适配不同屏幕尺寸和分辨率。

### 3.3. 安全性要求

- **隐私保护**: 严格遵循零数据收集原则，所有设置仅存储在本地。
- **安全沙箱**: 预览内容在隔离的iframe环境中运行，防止恶意脚本。
- **权限最小化**: 仅申请必要的浏览器权限，透明化权限使用。
- **内容安全**: 实施内容安全策略(CSP)，防范XSS攻击。

### 3.4. 可用性要求

- **直观界面**: 设置面板采用现代化设计，操作简单直观。
- **即时反馈**: 所有用户操作提供实时视觉反馈和状态提示。
- **错误处理**: 优雅处理各种异常情况，提供有用的错误信息。
- **无障碍访问**: 支持键盘导航和屏幕阅读器，符合WCAG 2.1标准。

---

## 4. 技术架构要求

### 4.1. 开发技术栈

- **开发框架**: WXT (Next-generation Web Extension Framework)
- **前端技术**: React 18 + TypeScript 5
- **样式方案**: Tailwind CSS 4.0 + shadcn/ui组件库
- **构建工具**: Vite (WXT内置)
- **包管理**: pnpm

### 4.2. 扩展标准

- **规范版本**: Manifest V3，确保未来兼容性
- **权限管理**: 采用最小权限原则，动态权限申请
- **API使用**: 充分利用现代浏览器扩展API

### 4.3. 数据存储方案

- **设置存储**: chrome.storage.local存储用户配置
- **状态管理**: React状态管理 + 自定义Hooks
- **数据同步**: 支持跨设备设置同步（可选）
- **数据验证**: 完整的数据格式验证和错误恢复

### 4.4. 国际化支持

- **多语言架构**: 基于React i18n的完整国际化方案
- **语言覆盖**: 支持12种主要语言
- **动态切换**: 运行时语言切换，无需重启
- **本地化适配**: 针对不同地区的UI和交互优化

---

## 5. 用户体验设计

### 5.1. 交互设计原则

- **多样化触发**: 6种触发方式满足不同用户习惯，包括拖动链接、鼠标悬停、长按、快捷键点击、快捷键悬停和禁用选项。
- **智能适配**: 根据操作系统自动调整默认快捷键，确保跨平台兼容性。
- **流畅动画**: 60fps的平滑过渡动画，提供优质视觉体验。
- **直观操作**: 拖拽、调整大小等操作提供实时视觉反馈，增强用户控制感。
- **资源管理**: 通过悬浮窗数量限制和自动固定功能，帮助用户有效管理屏幕空间和系统资源。
- **智能验证**: 实时验证用户输入，如域名格式检查和数量限制，提供即时反馈。

### 5.2. 视觉设计规范

- **主题系统**: 支持系统主题跟随和手动切换
- **设计一致性**: 统一的设计语言和视觉风格
- **现代化UI**: 采用最新的设计趋势和最佳实践
- **品牌识别**: 保持产品视觉识别的一致性

### 5.3. 响应式设计

- **自适应布局**: 适配不同屏幕尺寸和分辨率
- **触控优化**: 支持触屏设备的操作体验
- **高DPI支持**: 完美支持高分辨率显示器

---

## 6. 质量保证

### 6.1. 测试策略

- **单元测试**: 核心功能和工具函数的完整测试覆盖
- **集成测试**: 组件间交互和数据流测试
- **端到端测试**: 完整用户场景的自动化测试
- **性能测试**: 内存使用、响应时间等性能指标监控

### 6.2. 兼容性测试

- **浏览器测试**: 多版本Chrome和Edge的兼容性验证
- **系统测试**: Windows、macOS、Linux平台测试
- **网站测试**: 主流网站的预览兼容性测试

### 6.3. 用户测试

- **可用性测试**: 真实用户的使用体验评估
- **A/B测试**: 不同设计方案的效果对比
- **反馈收集**: 持续的用户反馈收集和分析

---

## 7. 发布与维护

### 7.1. 版本规划

- **v2.0**: 初始版本，完整的链接预览和拖拽文本功能。
- **v2.1**: 新增自动固定功能、悬浮窗数量限制、增强的拖拽文本设置、改进的触发方式和主题系统。
- **v2.2**: 性能优化和用户体验改进。
- **v2.3**: 新增功能和更多自定义选项。
- **v3.0**: AI增强功能（智能摘要、内容分析等）。

### 7.2. 发布渠道

- **Chrome Web Store**: 主要发布平台
- **Microsoft Edge Add-ons**: Edge用户支持
- **GitHub Releases**: 开源版本发布
- **官方网站**: 产品介绍和下载引导

### 7.3. 维护计划

- **定期更新**: 每月安全更新，季度功能更新
- **问题修复**: 7x24小时问题响应机制
- **用户支持**: 完善的用户文档和技术支持

---

## 8. 成功指标

### 8.1. 用户增长指标

- **安装量**: 发布6个月内达到50,000次安装
- **活跃用户**: 日活跃用户率保持在40%以上
- **用户留存**: 7日留存率达到60%以上
- **用户评分**: 应用商店评分保持4.5分以上

### 8.2. 功能性能指标

- **预览成功率**: 链接预览成功率达到98%以上
- **响应时间**: 悬浮窗打开时间控制在150ms以内
- **稳定性**: 扩展崩溃率控制在0.05%以下
- **资源占用**: 内存使用控制在合理范围内

### 8.3. 用户满意度指标

- **功能满意度**: 核心功能满意度达到90%以上
- **易用性评分**: 界面易用性评分达到4.5分以上
- **推荐意愿**: 用户推荐意愿达到80%以上

---

## 9. 风险管理

### 9.1. 技术风险

- **浏览器API变更**: 密切关注Manifest V3的更新变化
- **第三方依赖**: 定期更新依赖库，确保安全性
- **性能瓶颈**: 持续监控和优化性能表现

### 9.2. 市场风险

- **竞争分析**: 定期分析竞品功能和市场策略
- **用户需求变化**: 持续收集用户反馈，快速响应需求变化
- **技术趋势**: 跟踪前端技术发展趋势

### 9.3. 合规风险

- **隐私法规**: 严格遵循GDPR、CCPA等隐私保护法规
- **应用商店政策**: 及时适应各大应用商店的政策变化
- **开源协议**: 确保所有依赖库的许可证合规

---

## 10. 附录

### 10.1. 技术参考

- [WXT Framework Documentation](https://wxt.dev/)
- [Chrome Extensions Developer Guide](https://developer.chrome.com/docs/extensions/)
- [React 18 Documentation](https://react.dev/)
- [Tailwind CSS Documentation](https://tailwindcss.com/)

### 10.2. 设计参考

- [Material Design Guidelines](https://material.io/design)
- [Human Interface Guidelines](https://developer.apple.com/design/human-interface-guidelines/)
- [Web Content Accessibility Guidelines](https://www.w3.org/WAI/WCAG21/quickref/)

### 10.3. 版本历史

| 版本 | 日期 | 主要变更 | 负责人 |
|------|------|----------|--------|
| 1.0 | 2025-01-10 | 初始版本发布 | 开发团队 |
| 1.5 | 2025-01-12 | 增加拖拽文本功能 | 开发团队 |
| 2.0 | 2025-01-15 | 完整功能重构，PRD更新 | 产品团队 |
| 2.1 | 2025-01-18 | 新增自动固定功能、悬浮窗数量限制、增强拖拽文本设置、改进触发方式和主题系统 | 产品团队 |